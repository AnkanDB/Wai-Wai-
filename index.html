<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WAI JIYA WAI üíå</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='12' fill='%23ff6b9a'/><text x='50%' y='58%' font-family='Quicksand, Arial' font-size='28' font-weight='700' text-anchor='middle' fill='white'>jiya</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#fff0f6;
    --accent:#ff6b9a;
    --soft:#ffdbe6;
    --text:#42243b;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial; background: linear-gradient(180deg,#fff8fb 0%,var(--bg) 100%);}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;box-sizing:border-box;}
  .card{width:920px;max-width:96vw;background:linear-gradient(180deg,#ffffffcc, #fff0f5cc);border-radius:16px;padding:28px;box-shadow:0 10px 30px rgba(133,21,76,0.12);position:relative;overflow:hidden;}
  header{display:flex;align-items:center;gap:16px;margin-bottom:12px;}
  .logo{width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--accent),#ffb3c7);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:28px;font-family:'Quicksand', Arial, sans-serif;box-shadow:0 6px 18px rgba(255,107,154,0.18);} 
  h1{margin:0;color:var(--text);font-family:'Quicksand', Arial, sans-serif;font-size:30px;font-weight:700;}
  p.lead{margin:6px 0 18px;color:#5b3a4f;}
  .center{display:flex;align-items:center;justify-content:center;}
  button.btn{background:var(--accent);border:none;color:white;padding:10px 18px;border-radius:10px;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(255,107,154,0.18);}
  .hidden{display:none !important;}

/* question area */
  .quiz{min-height:360px;display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:center;}
  .qbox{width:100%;background:rgba(255,255,255,0.8);border-radius:12px;padding:20px;box-sizing:border-box;box-shadow:0 6px 18px rgba(0,0,0,0.06);text-align:center;}
  /* smooth transitions for next/back */
  .qbox.animating{pointer-events:none}
  @keyframes slideOutLeft{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(-24px)}}
  @keyframes slideOutRight{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(24px)}}
  @keyframes slideInLeft{0%{opacity:0;transform:translateX(-24px)}100%{opacity:1;transform:translateX(0)}}
  @keyframes slideInRight{0%{opacity:0;transform:translateX(24px)}100%{opacity:1;transform:translateX(0)}}
  .qbox.exit-left{animation:slideOutLeft 240ms ease forwards}
  .qbox.exit-right{animation:slideOutRight 240ms ease forwards}
  .qbox.enter-left{animation:slideInLeft 260ms ease forwards}
  .qbox.enter-right{animation:slideInRight 260ms ease forwards}
  .question{font-size:20px;color:#6b2b47;margin:0 0 12px;}
  .options{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;}
  .option{padding:10px 14px;border-radius:10px;border:1px solid #ffd0e3;background:transparent;cursor:pointer;min-width:120px;}
  .option.selected{background:var(--accent);color:white;border-color:transparent;box-shadow:0 6px 12px rgba(255,107,154,0.14);}
  input[type=text]{padding:10px 12px;border-radius:10px;border:1px solid #f0cfe0;width:100%;max-width:420px;font-size:16px;}

/* envelope + letter */
  .envelope-wrap{display:flex;flex-direction:column;align-items:center;gap:12px;padding-top:10px;}
  .envelope{width:360px;height:220px;position:relative;perspective:1000px;cursor:pointer;}
  .flap, .body-env{position:absolute;left:0;right:0;top:0;margin:auto;width:100%;height:100%;border-radius:12px;backface-visibility:hidden;transform-style:preserve-3d;}
  .body-env{background:linear-gradient(180deg,#fff,#fff0f6);border:2px solid #ffd0e3;height:220px;box-shadow:0 12px 40px rgba(133,21,76,0.06);overflow:hidden;padding:22px;box-sizing:border-box;}
  .flap{height:130px;top:-10px;border-radius:18px;background:linear-gradient(135deg,var(--accent),#ffb3c7);transform-origin:top center;transform:rotateX(0deg) translateZ(1px);transition:transform 900ms cubic-bezier(.17,.84,.44,1), box-shadow 300ms ease;box-shadow:0 10px 26px rgba(133,21,76,0.18);border:2px solid #ffb3c7;z-index:2;}
  .flap.open{transform:rotateX(-175deg) translateZ(1px);} 
  .body-env::before{content:"";position:absolute;inset:10px 12px 14px;background:linear-gradient(180deg,#fffdfd,#fff5f8);border-radius:10px;z-index:0;}
  .letter{position:relative;width:86%;height:78%;max-height:78%;margin:0 auto;background:linear-gradient(white,#fff9fb);border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,0.06);opacity:0;transform:translateY(12px) scale(0.98);transition:opacity 500ms ease 200ms, transform 600ms ease 200ms;overflow:auto;white-space:pre-wrap;}
  .letter.visible{opacity:1;transform:translateY(0) scale(1);} 

/* typing effect */
  .typed{font-family:Georgia, 'Times New Roman', serif;color:#4a263a;line-height:1.45;font-size:16px;}

/* heart background */
  .hearts{position:absolute;inset:0;pointer-events:none;overflow:hidden;}
  /* improved heart shower: clean SVG hearts with sway */
  .heart-wrap{position:absolute;will-change:transform;animation:sway ease-in-out infinite;}
  .heart-svg{display:block;opacity:0.95;filter:drop-shadow(0 4px 10px rgba(133,21,76,0.18));animation:fallDown linear infinite;will-change:transform;}
  @keyframes fallDown{
    0%{transform:translateY(-20vh) rotate(0deg);opacity:0}
    10%{opacity:0.98}
    100%{transform:translateY(110vh) rotate(360deg);opacity:0}
  }
  @keyframes sway{
    0%{transform:translateX(-6px)}
    50%{transform:translateX(6px)}
    100%{transform:translateX(-6px)}
  }

/* confetti canvas sits on top when fired */
  canvas.confetti{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;}

/* footer controls */
  .controls{display:flex;gap:12px;align-items:center;justify-content:center;margin-top:10px;flex-wrap:wrap;}
  .muted{opacity:0.85;font-size:13px;color:#6b2b47;}
  .small{font-size:13px;color:#6b2b47}

/* responsive */
  @media (max-width:560px){
    .card{padding:16px;border-radius:12px;}
    .envelope{width:300px;height:200px;}
    .logo{width:56px;height:56px}
    h1{font-size:26px}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card">
    <div class="hearts" id="hearts"></div>
    <canvas class="confetti" id="confettiCanvas"></canvas>

    <header>
      <div class="logo">jiya</div>
      <div>
        <h1>WAI JIYA WAI üíå</h1>
        <p class="lead">A tiny quiz ‚Äî answer with your heart. Finish and open your surprise letter.</p>
      </div>
    </header>

    <!-- START SCREEN -->
    <div id="startScreen" class="">
      <div class="center" style="flex-direction:column;gap:18px">
        <img src="" id="heroImg" alt="" style="width:160px;height:160px;border-radius:14px;object-fit:cover;display:none;box-shadow:0 18px 40px rgba(133,21,76,0.08)">
        <p class="small">Made with ‚ù§Ô∏è by <strong>Dettolborma üòò</strong></p>
        <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center;">
          <button class="btn" id="startBtn">Start the little quiz</button>
          <button class="btn" id="viewLastBtn" style="background:#ffd0e3;color:#6b2b47;border:1px solid rgba(107,43,71,0.06)">View last answers</button>
        </div>
      </div>
    </div>

    <!-- QUIZ -->
    <div id="quiz" class="hidden">
      <div class="quiz">
        <div class="qbox" id="qbox">
          <p class="question" id="questionText">Question text</p>
          <div class="options" id="options"></div>
          <div id="textInputWrap" style="display:none;margin-top:12px;">
            <input type="text" id="textInput" placeholder="Type here..." />
          </div>
        </div>

        <div class="controls">
          <button class="btn" id="prevBtn" style="background:#ffd0e3;color:#6b2b47;border:1px solid rgba(107,43,71,0.06)">Back</button>
          <button class="btn" id="nextBtn">Next</button>
          <div class="muted" id="qcount">1 / 10</div>
        </div>
      </div>
    </div>

    <!-- FINAL ENVELOPE -->
    <div id="final" class="hidden">
      <div class="envelope-wrap center">
        <div style="text-align:center">
          <p class="small">Tap the envelope to open your letter</p>
        </div>
        <div class="envelope" id="envelope">
          <div class="flap" id="flap"></div>
          <div class="body-env">
            <div class="letter" id="letter">
              <div class="typed" id="typedText">...</div>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:12px;align-items:center;"></div>

        <div id="summaryWrap" style="margin-top:12px;max-width:640px;width:100%;display:none;flex-direction:column;gap:8px;">
          <div style="display:flex;gap:8px;align-items:center;justify-content:flex-start;">
            <button class="btn" id="copyAnswersBtn" style="background:#ffd0e3;color:#6b2b47;border:1px solid rgba(107,43,71,0.06)">Copy answers</button>
            <span class="small" id="copyStatus" style="display:none;">Copied!</span>
          </div>
          <pre id="summaryText" class="small" style="background:rgba(255,255,255,0.8);border:1px solid #ffd0e3;padding:12px;border-radius:10px;white-space:pre-wrap;max-height:220px;overflow:auto;"></pre>
        </div>
      </div>
    </div>

  </div>
</div>



<script>
/* -------------------------
   QUESTIONS & default data
   ------------------------- */
const questions = [
  {id:1, q:"What's the nickname you like most when I call you?", type:"choice", opts:["Baby","Babu","Maggi","Babe"]},
  {id:2, q:"If I kidnapped you for a day, where would you want me to take you?", type:"text"},
  {id:3, q:"If I asked ‚Äúdo you like me?‚Äù your reply would be‚Ä¶", type:"choice", opts:["Yes üòç","Why not","Tere jaise chutiya ladka ko konsa psnd karega üòû"]},
  {id:4, q:"Your favourite Colour", type:"text"},
  {id:5, q:"If we shared earphones, which song would you want us to listen to? üé∂ (Serious answer üòí)", type:"text"},
  {id:6, q:"What‚Äôs your favourite flower‚Ä¶ or the one you‚Äôd secretly want me to bring for you? üå∏üíê", type:"text"},
  {id:7, q:"If I gave you three words right now, you‚Äôd want them to be‚Ä¶", type:"choice", opts:["You are very cute","I miss you","Always with you"]},
  {id:8, q:"If we ever got the same accessory, what would you want it to be", type:"choice", opts:["Ring","Bracelet"]},
  {id:9, q:"One word that describes how I make you feel", type:"text"},
  {id:10, q:"A secret place you'd like us to visit together someday", type:"text"}
];

let answers = {}; // store answers keyed by question id
let current = 0;

/* -------------------------
   UI elements
   ------------------------- */
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const quiz = document.getElementById('quiz');
const questionText = document.getElementById('questionText');
const optionsWrap = document.getElementById('options');
const textInputWrap = document.getElementById('textInputWrap');
const textInput = document.getElementById('textInput');
const qcount = document.getElementById('qcount');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const final = document.getElementById('final');
const flap = document.getElementById('flap');
const envelope = document.getElementById('envelope');
const letter = document.getElementById('letter');
const typedText = document.getElementById('typedText');
// music controls removed

/* -------------------------
   Heart background
   ------------------------- */
const heartsEl = document.getElementById('hearts');
function makeHearts(n=32){
  const colors = ['#ff6b9a','#ff86ab','#ffb3c7','#ff8fb7'];
  for(let i=0;i<n;i++){
    const size = 14 + Math.random()*18;
    const left = Math.random()*100;
    const duration = 8 + Math.random()*10;
    const delay = -Math.random()*duration;
    const swayDur = 3 + Math.random()*2;
    const color = colors[Math.floor(Math.random()*colors.length)];
    const wrap = document.createElement('div');
    wrap.className = 'heart-wrap';
    wrap.style.left = `${left}vw`;
    wrap.style.top = `${-10 - Math.random()*30}vh`;
    wrap.style.animationDuration = `${swayDur}s`;
    wrap.style.animationDelay = `${Math.random()}s`;
    const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
    svg.setAttribute('class','heart-svg');
    svg.setAttribute('width', String(size));
    svg.setAttribute('height', String(size));
    svg.setAttribute('viewBox','0 0 24 24');
    svg.style.animationDuration = `${duration}s`;
    svg.style.animationDelay = `${delay}s`;
    const path = document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('fill', color);
    path.setAttribute('d','M12 21s-6.716-4.323-9.193-8.077C.84 10.22 2.08 6.5 5.4 6.5c2.06 0 3.2 1.2 3.6 1.8.4-.6 1.54-1.8 3.6-1.8 3.32 0 4.56 3.72 2.593 6.423C18.716 16.677 12 21 12 21z');
    svg.appendChild(path);
    wrap.appendChild(svg);
    heartsEl.appendChild(wrap);
  }
}
makeHearts(32);

/* -------------------------
   Start button
   ------------------------- */
startBtn.addEventListener('click', ()=>{
  startScreen.classList.add('hidden');
  quiz.classList.remove('hidden');
  current = 0;
  renderQuestion();
});

/* -------------------------
   Render question
   ------------------------- */
function renderQuestion(){
  const q = questions[current];
  questionText.textContent = q.q;
  optionsWrap.innerHTML = '';
  textInputWrap.style.display = 'none';
  textInput.value = '';
  qcount.textContent = `${current+1} / ${questions.length}`;
  prevBtn.style.display = current===0 ? 'none' : 'inline-block';
  nextBtn.textContent = (current===questions.length-1) ? 'Finish' : 'Next';

  if(q.type === 'choice'){
    q.opts.forEach(opt=>{
      const btn = document.createElement('div');
      btn.className='option';
      btn.textContent = opt;
      btn.addEventListener('click', ()=> {
        // deselect siblings
        Array.from(optionsWrap.children).forEach(c=>c.classList.remove('selected'));
        btn.classList.add('selected');
        answers[q.id] = opt;
      });
      // if we already have answer - mark it
      if(answers[q.id] === opt) btn.classList.add('selected');
      optionsWrap.appendChild(btn);
    });
  } else if(q.type === 'text'){
    textInputWrap.style.display = 'block';
    if(answers[q.id]) textInput.value = answers[q.id];
    textInput.focus();
  }
}

/* -------------------------
   Navigation controls
   ------------------------- */
function animateQuestionExit(direction){
  const qbox = document.getElementById('qbox');
  qbox.classList.add('animating');
  qbox.classList.add(direction === 'next' ? 'exit-left' : 'exit-right');
  return new Promise(res=> setTimeout(res, 240));
}
function animateQuestionEnter(direction){
  const qbox = document.getElementById('qbox');
  qbox.classList.remove('exit-left','exit-right');
  qbox.classList.add(direction === 'next' ? 'enter-right' : 'enter-left');
  setTimeout(()=>{
    qbox.classList.remove('animating','enter-right','enter-left');
  }, 280);
}

nextBtn.addEventListener('click', async ()=> {
  // save text input if any
  const q = questions[current];
  if(q.type === 'text'){
    const val = textInput.value.trim();
    if(val === '') {
      // allow blank? better encourage: prompt visually briefly
      textInput.placeholder = 'Type something sweet üòä';
      textInput.focus();
      return;
    }
    answers[q.id] = val;
  } else {
    if(!answers[q.id]){
      // require selection
      const el = document.querySelector('.option');
      if(!el){ alert('Please select an option.'); return; }
      // if nothing selected, nudge
      const selected = document.querySelector('.option.selected');
      if(!selected){ alert('Please choose one.'); return; }
    }
  }

  if(current < questions.length - 1){
    await animateQuestionExit('next');
    current++;
    renderQuestion();
    animateQuestionEnter('next');
  } else {
    // finish
    quiz.classList.add('hidden');
    final.classList.remove('hidden');
    // save answers to Google Sheets
    saveAnswersToSheets();
    // small delay then show flap open on click
    setTimeout(()=>{ initEnvelope(); }, 500);
  }
});

prevBtn.addEventListener('click', async ()=> {
  if(current>0){
    await animateQuestionExit('prev');
    current--; renderQuestion();
    animateQuestionEnter('prev');
  }
});

/* -------------------------
   Envelope & letter animations
   ------------------------- */
function initEnvelope(){
  // set typed text placeholder while closed
  typedText.textContent = '';
  letter.classList.remove('visible');
  flap.classList.remove('open');

  // click to open
  envelope.onclick = async ()=>{
    envelope.onclick = null; // prevent double clicks
    flap.classList.add('open');
    // simulate letter sliding up as flap opens
    setTimeout(()=> {
      letter.classList.add('visible');
      letter.style.transform = 'translateY(-8px) scale(1)';
      // generate the letter text from answers
      const letterContent = generateLetter();
      typeText(letterContent, typedText, ()=> {
        // after letter typed, fire confetti
        fireConfetti();
        // show human-readable summary
        showSummary();
      });
    }, 650);
  };
}

/* -------------------------
   Compose personalized love letter
   ------------------------- */
function generateLetter(){
  return `Hey you ‚Äî my favourite little storm,

Every time you start that cute, angry-yappy routine, I swear the world gets a little brighter. It‚Äôs ridiculous how a single message from you can turn a dull day into one with a stupid grin I can‚Äôt hide. You do things your way, loud or soft, messy or perfect ‚Äî and somehow it‚Äôs always... right. Don‚Äôt ever doubt that.

I won‚Äôt shout it from the roof or write it in big letters, but my days have started arranging themselves around the idea of you ‚Äî your laugh, your stubbornness, the way you make small things feel important. If something knocks you down, I want to be the one who helps you up. If you need someone to annoy you back or to quietly cheer while you chase whatever you want, I‚Äôm here.

Keep being annoyingly amazing. Keep that spark. Just don‚Äôt go ‚Äî not when you‚Äôve already become the reason I smile for no reason.

Always on your side,
‚Äî Dettolborma `;
}

/* -------------------------
   Typing animation
   ------------------------- */
function typeText(text, el, done){
  el.textContent = '';
  const chars = text.split('');
  let i = 0;
  const interval = 18 + Math.random()*12;
  function step(){
    if(i < chars.length){
      el.textContent += chars[i] === '\n' ? '\n' : chars[i];
      i++;
      // scroll if necessary
      el.parentElement.scrollTop = el.parentElement.scrollHeight;
      setTimeout(step, interval + (Math.random()*30));
    } else {
      // small sparkle effect
      sparkles(el);
      done && done();
    }
  }
  step();
}

/* -------------------------
   Sparkles (tiny CSS glow)
   ------------------------- */
function sparkles(el){
  el.style.boxShadow = '0 8px 40px rgba(255,107,154,0.06)';
  el.style.borderRadius = '8px';
  setTimeout(()=>{ el.style.boxShadow=''; }, 2200);
}

/* -------------------------
   Download letter as .txt
   ------------------------- */
// download removed

/* -------------------------
   Restart
   ------------------------- */
// restart removed

// music controls removed

/* -------------------------
   Save answers to Google Sheets
   ------------------------- */
function saveAnswersToSheets(){
  // Replace this URL with your Google Apps Script web app URL
  const WEBHOOK_URL = 'https://script.google.com/macros/s/AKfycbyaDVOsn7nNzOC5d1zVuNB0qzucH2caCdKU7aoMajYxXoYyOTMjSINpX_434fEwexX_/exec';
  
  const data = {
    timestamp: new Date().toISOString(),
    answers: answers,
    questions: questions.map(q => ({ id: q.id, question: q.q }))
  };
  // Always keep a local copy for easy viewing later
  try { localStorage.setItem('quizAnswers_' + Date.now(), JSON.stringify(data)); } catch(_) {}
  
  fetch(WEBHOOK_URL, {
    method: 'POST',
    mode: 'no-cors', // Required for Google Apps Script
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data)
  }).catch(err => {
    console.log('Could not save to sheets:', err);
    // Fallback: save to localStorage
    localStorage.setItem('quizAnswers_' + Date.now(), JSON.stringify(data));
  });
}

/* -------------------------
   Summary helpers
   ------------------------- */
function buildSummaryText(){
  const lines = questions.map(q => {
    const a = answers[q.id];
    return `Q: ${q.q}\nA: ${a ? a : '(blank)'}`;
  });
  return lines.join('\n\n');
}

function showSummary(){
  const wrap = document.getElementById('summaryWrap');
  const pre = document.getElementById('summaryText');
  if(!wrap || !pre) return;
  pre.textContent = buildSummaryText();
  wrap.style.display = 'flex';
}

const copyBtn = document.getElementById('copyAnswersBtn');
const copyStatus = document.getElementById('copyStatus');
if(copyBtn){
  copyBtn.addEventListener('click', async ()=>{
    try{
      await navigator.clipboard.writeText(buildSummaryText());
      if(copyStatus){
        copyStatus.style.display = 'inline';
        setTimeout(()=> copyStatus.style.display = 'none', 1600);
      }
    } catch(e){
      alert('Copy failed.');
    }
  });
}

const viewLastBtn = document.getElementById('viewLastBtn');
if(viewLastBtn){
  viewLastBtn.addEventListener('click', ()=>{
    const keys = Object.keys(localStorage).filter(k=>k.startsWith('quizAnswers_')).sort();
    if(keys.length===0){ alert('No saved answers found.'); return; }
    const last = JSON.parse(localStorage.getItem(keys[keys.length-1])||'{}');
    const lines = (last.questions||[]).map(q=>{
      const a = (last.answers||{})[q.id];
      return `Q: ${q.question}\nA: ${a ? a : '(blank)'}`;
    });
    alert(lines.join('\n\n'));
  });
}

/* -------------------------
   Confetti (simple)
   ------------------------- */
const confCanvas = document.getElementById('confettiCanvas');
const ctx = confCanvas.getContext('2d');
let confettiPieces = [];
function resizeCanvas(){
  confCanvas.width = confCanvas.clientWidth;
  confCanvas.height = confCanvas.clientHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function fireConfetti(){
  confettiPieces = [];
  const count = 60;
  for(let i=0;i<count;i++){
    confettiPieces.push({
      x: Math.random()*confCanvas.width,
      y: Math.random()*confCanvas.height - confCanvas.height,
      w: 6 + Math.random()*12,
      h: 8 + Math.random()*8,
      dx: -2 + Math.random()*4,
      dy: 2 + Math.random()*6,
      color: ['#ff6b9a','#ffd0e3','#ffb3c7','#ffd96a','#d0b3ff'][Math.floor(Math.random()*5)],
      rot: Math.random()*360,
      vel: Math.random()*3+2
    });
  }
  animateConfetti();
}

let confAnimId = null;
function animateConfetti(){
  if(confAnimId) cancelAnimationFrame(confAnimId);
  function step(){
    ctx.clearRect(0,0,confCanvas.width,confCanvas.height);
    confettiPieces.forEach((p)=>{
      p.x += p.dx;
      p.y += p.dy;
      p.rot += p.dx * 2;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot*Math.PI/180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    });
    // keep animating until pieces are out
    confAnimId = requestAnimationFrame(step);
  }
  step();
  // stop after 4s
  setTimeout(()=>{ if(confAnimId) cancelAnimationFrame(confAnimId); ctx.clearRect(0,0,confCanvas.width,confCanvas.height); }, 4200);
}

/* -------------------------
   Small helper: autoplay hint
   ------------------------- */
document.addEventListener('visibilitychange', ()=> {
  if(document.visibilityState === 'visible'){
    // nothing heavy
  }
});

/* -------------------------
   Init: prefill optional hero image (if you add one)
   ------------------------- */
(function init(){
  const heroImg = document.getElementById('heroImg');
  // If you place an image at assets/hero.jpg, uncomment these lines:
  // heroImg.src = 'assets/hero.jpg';
  // heroImg.style.display = 'block';
})();
</script>

<!--
  NOTES / HOW TO CUSTOMIZE:

  1) Add your music:
     - Put a music file (mp3) into your project folder at: assets/music.mp3
     - OR change the audio source in the <audio id="bgMusic"> element above to your path.
     - Browsers often block autoplay ‚Äî use the "Play Music" button in the UI.

  2) Add a hero image:
     - Place an image at assets/hero.jpg and uncomment lines in the init() function near the bottom.

  3) Change "Your Name":
     - Replace 'Your Name' in generateLetter() with your real name.

  4) Host:
     - Save this as index.html and upload the file (and assets folder with music and images) to GitHub Pages / Netlify / Vercel (instructions below).

  5) Make edits:
     - Edit questions array at top to change questions or options.

  6) Download:
     - "Download Letter" saves a simple text file. If you want a styled PDF you can integrate a library like jsPDF (requires adding the library).

-->

</body>
</html>
